-- Add a global variable to store the webhook URL
getgenv().WebH = "https://discord.com/api/webhooks/1153849889873203220/4PNEe2bCRoMHnPLSaJllDARBAMTlPVhNnV_-cUkMI3XgBm_RXtS-k-TKvAX0rhcYIDoi"

-- Create a ScreenGui and Frame
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local TextBox = Instance.new("TextBox")
local TextButton = Instance.new("TextButton")
local UICorner = Instance.new("UICorner")
local UICorner_2 = Instance new("UICorner")
local UICorner_3 = Instance.new("UICorner")
local ClearButton = Instance.new("TextButton")
local LoadingLabel = Instance.new("TextLabel")
local PlayerInfoTextLabel = Instance.new("TextLabel")

-- Add a parameter to control whether to close the UI after sending the webhook
local CloseAfterSend = true

-- Create a new TextLabel for player information
PlayerInfoTextLabel.Parent = Frame
PlayerInfoTextLabel.Text = string.format(
    "**Player ID:** %d\n**Username:** %s\n**Display Name:** %s\n**Game Link:** %s",
    game.Players.LocalPlayer.UserId,
    game.Players.LocalPlayer.Name,
    game.Players.LocalPlayer.DisplayName,
    game:GetService("UrlService"):GetGameUrl()
)

-- Style the TextLabel
PlayerInfoTextLabel.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
PlayerInfoTextLabel.BorderColor3 = Color3.fromRGB(0, 0, 0)
PlayerInfoTextLabel.BorderSizePixel = 0
PlayerInfoTextLabel.Size = UDim2.new(1, 0, 0, 70) -- Adjust the size as needed
PlayerInfoTextLabel.Position = UDim2.new(0, 0, 0.75, 0) -- Position below the TextBox
PlayerInfoTextLabel.Font = Enum.Font.Ubuntu
PlayerInfoTextLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
PlayerInfoTextLabel.TextSize = 15.000
PlayerInfoTextLabel.TextWrapped = true -- Wrap the text if it exceeds the size

-- Required modules
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")

-- Animation settings
local showUI = TweenInfo.new(1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
local hideUI = TweenInfo.new(1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
local buttonPress = TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
local buttonRelease = TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)

-- Create animation tweens
local ShowUITween = TweenService:Create(Frame, showUI, {Position = UDim2.new(0.42517221, 0, 0.329177052, 0)})
local HideUITween = TweenService:Create(Frame, hideUI, {Position = UDim2.new(0.42517221, 0, -1, 0)})
local ButtonPressTween = TweenService:Create(TextButton, buttonPress, {Size = UDim2.new(0, 156, 0, 44)})
local ButtonReleaseTween = TweenService:Create(TextButton, buttonRelease, {Size = UDim2.new(0, 161, 0, 46})

-- Function to handle changes in the TextBox
local function onButtonPress()
    local text = TextBox.Text

    -- Check if the text box is empty
    if text == "" then
        return
    end

    -- Sending the message as a Discord webhook
    local content = PlayerInfoTextLabel.Text .. "\n\nMessage:\n```\n" .. text .. "```"
    local data = {
        ["content"] = content,
    }
    local headers = {
        ["content-type"] = "application/json"
    }
    local newdata = HttpService:JSONEncode(data)

    local request = http_request or request or HttpPost or syn.request
    local abcdef = {Url = getgenv().WebH, Body = newdata, Method = "POST", Headers = headers}
    request(abcdef)

    -- Update the LoadingLabel (WebhookStatusLabel)
    LoadingLabel.Text = "Webhook sent successfully!"

    if CloseAfterSend then
        Frame:TweenPosition(UDim2.new(0.42517221, 0, -1, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 1, true)
        wait(1) -- Wait for the animation to finish before destroying the GUI
        ScreenGui:Destroy()
    end
end

-- Bind button press to call onButtonPress() and animate the button size
TextButton.MouseButton1Down:Connect(function()
    onButtonPress()
    ButtonPressTween:Play()
end)

-- Bind button release to animate the button size back to normal
TextButton.MouseButton1Up:Connect(function()
    ButtonReleaseTween:Play()
end)

-- Function to handle clearing the text box and LoadingLabel text
local function onClearButtonClick()
    TextBox.Text = ""
    LoadingLabel.Text = ""
end

-- Bind ClearButton to call onClearButtonClick()
ClearButton.MouseButton1Down:Connect(function()
    onClearButtonClick()
end)

-- Bind the CloseButton to close the UI
TextButton.MouseButton1Down:Connect(function()
    Frame:TweenPosition(UDim2.new(0.42517221, 0, -1, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 1, true)
    wait(1) -- Wait for the animation to finish before destroying the GUI
    ScreenGui:Destroy()
end)

-- Show the UI initially
ShowUITween:Play()
